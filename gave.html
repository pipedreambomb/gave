<head>
	<title>gave</title>
</head>

<body>
	{{> navbar}}
	<div class="container">
		{{renderPage}}
	</div>
</body>

<template name="navbar">
    <div class="navbar navbar-inverse navbar-fixed-top">
	  <div class="navbar-inner">
		  <div class="container">
			  <a class="brand {{#if PageIsHome}}active{{/if}}" href='/'>Giving Counts</a>
			  <ul class="nav">
				  <li {{#if PageIsAbout}}class="active"{{/if}}><a href='/about'>About</a></li>
				  {{#if UserIsLoggedIn}}
					  <li {{#if PageIsDashboard}}class="active"{{/if}}><a href='/dashboard'>My dashboard</a></li>
				  {{/if}}
				  <li>{{loginButtons}}</li>
			  </ul>
		  </div>
	  </div>
  </div>
</template>

<template name="home">
  <h2>Welcome to Giving Counts!</h2>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean a orci sed diam congue interdum vitae eget nisl. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nam non nisi sagittis enim molestie iaculis. Aenean ultrices condimentum lobortis. Quisque tempor purus magna, sit amet dignissim est. Morbi pellentesque augue sit amet mauris tempus pretium. Fusce vitae suscipit odio. Sed scelerisque laoreet lectus, eget sollicitudin ipsum tempus ac. Phasellus in erat eu metus accumsan condimentum. Sed at enim nibh, quis tempus nulla. Maecenas sed lacus metus, aliquet faucibus erat. Quisque molestie, urna nec porttitor adipiscing, leo ligula tempor lacus, sit amet lacinia libero quam sit amet quam. Nulla facilisi. Maecenas eget ante tellus. Phasellus at orci mauris. Etiam adipiscing facilisis lobortis.</p>
</template>
<template name="about">
  <h2>About Giving Counts!</h2>
  <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean a orci sed diam congue interdum vitae eget nisl. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Nam non nisi sagittis enim molestie iaculis. Aenean ultrices condimentum lobortis. Quisque tempor purus magna, sit amet dignissim est. Morbi pellentesque augue sit amet mauris tempus pretium. Fusce vitae suscipit odio. Sed scelerisque laoreet lectus, eget sollicitudin ipsum tempus ac. Phasellus in erat eu metus accumsan condimentum. Sed at enim nibh, quis tempus nulla. Maecenas sed lacus metus, aliquet faucibus erat. Quisque molestie, urna nec porttitor adipiscing, leo ligula tempor lacus, sit amet lacinia libero quam sit amet quam. Nulla facilisi. Maecenas eget ante tellus. Phasellus at orci mauris. Etiam adipiscing facilisis lobortis.</p>
</template>

<template name="dashboard">
<div class="row">
  <div class="span8">
	  <h2>Donations</h2>
	  {{> transactions }}
  </div>
  <div class="span4">
	  <h2>Causes</h2>
	  {{> causes_summary }}
	  <h2>Effects</h2>
	  {{> effects }}
  </div>
</div>
</template>

<template name="tests">
  <a href='/' class='btn'>Home</a>
  {{> mochaTestReport }}
</template>

<template name="transactions">
{{#if UserHasTransactions }}
	{{> transactions_chart }}
	{{> transactions_table }}
{{else}}
<p>You don't have any donations to display here. You should add one!</p>
{{/if}}
<a class="btn" id="add_transaction" href='/add'>Add <i class='icon-plus-sign'></i></a>
</template>

<template name="transactions_chart">
<canvas class="transactions-bar-chart"></canvas>
<div class="transactions-bar-chart-controls">
	Chart shows
	<select class="transactions-to-show-select span1">
		{{#each SelectNumberOfTransactionsOptions}}
		<option value="{{numTrans}}" 
				{{#if selected}}selected{{/if}}>
			{{numTrans}}
		</option>
		{{/each}}
	</select>
	recent transactions
</div>
</template>

<template name="transactions_table">
   <div id="TransactionsTable">
      <table>
         <tr>
            <th>Cause</th>
            <th>Amount</th>
            <th>Date</th>
            <th>Actions</th>
         </tr>
         {{#each Transactions}}
            <tr>
               <td>{{cause}}</td>
               <td>${{amount2dp}}</td>
               <td>{{niceDate}}</td>
	       <td>
		       <a class='btn btn-primary' href='/edit/{{_id}}'>Edit</a> 
		       <a class='btn btn-danger tran-del' href='#' data-cause-id="{{_id}}">Delete</a> 
	       </td>
            </tr>
         {{/each}}
         <tr>
		 <td colspan="4">Total: $<span class="Transactions_subtotal">{{SubTotal}}</span></td>
         </tr>
       </table>
   </div>
</template>

<template name="transaction">
<h1>{{Action}} donation</h1>
{{#if TransactionError}}
<div class="alert alert-error"><strong>Whoops!</strong> {{TransactionError}}</div>
{{/if}}
<div class="row">
	<div class="span8">
		<h2>Step 1: choose a cause</h2>
		{{> causes_info }}
	</div>
	<div class="span4">
		<h2>Step 2: enter a donation</h2>
		<form name="transaction">
		    <label>
			 {{#with Transaction}}
			 Amount
			 <div class="input-prepend">
				 <span class="add-on">$</span>
				 <input id="tranAmount" name="amount" value="{{amount}}" placeholder="E.g. 29.99" class="span2" type="text" {{#unless UserHasSelectedCause}}disabled{{/unless}}></input>
			 </div>
		    </label>
		    <label>
			 Date   
			 <input name="date" class="datepicker" value="{{shortDate}}" placeholder="E.g. 12/31/2012" type="text" {{#unless UserHasSelectedCause}}disabled{{/unless}}></input>
			 {{/with}}
		    </label>
		    {{> live_effects }}
		    <br/>
		    <h2>Step 3: confirm</h2>
		    <a href='#' class='btn btn-success' id='doneBtn'>Add this donation</a>
		    <a href='#' class='btn' id='cancelBtn'>Cancel</a>
		  </form>
	  </div>
  </div>
</template>

<template name="live_effects">
<h3>Effects (updated as you type):</h3>
	<ul>
		{{#each Effects}}
			{{#if nocause}}
				<li>No cause selected.</li>
			{{/if}}
			{{#if noamount}}
				<li>No amount selected.</li>
			{{/if}}
			{{#if amount}}
				<li>{{description}}: {{amount_2dp}}</li>
			{{/if}}
		{{/each}}
	</ul>
</template>

<template name="causes_summary">
{{#if UserHasTransactions}}
	<canvas class="causes-pie-chart"></canvas>
	<table>
		<tr>
			<th>Cause</th>
			<th>Total</th>
		</tr>
		{{#each Causes}}
		<tr>
			<td>{{name}}</td>
			<td>${{total}}</td>
		</tr>
		{{/each}}
		 <tr>
		    <td colspan="2">Total: ${{SubTotal}}</td>
		 </tr>
	</table>
{{else}}
	<p>As soon as you add some transactions, a summary of the causes you have given to will appear here.</p>
{{/if}}
</template>

<!-- Display information about each cause when creating a new donation -->
<template name="causes_info">
{{#each Causes}}
<div class="cause_info {{selected}}">
	<hr/>
	<h3>{{name}}</h3>
	<h4>Category: {{category}}</h4>
	<p><a href="{{website}}" target='_blank'>Visit website</a></p>
	<p>{{description}}</p>
	<div class="row">
		<div class="span6">
			<p>Effects:</p>
			<ul>
			{{#each sorted_effects}}
			<li>1 <span class="lowercase">{{descr_singular}}</span> for every ${{perDollars}} given
				<sup><a href="{{evidence}}" target='_blank'>[ref]</a></sup>
			</li>
			{{/each}}
			</ul>
		</div>
		<div class="span2">
			<a href='#' class="btn select-cause" data-cause-id="{{_id}}">Select</a>
		</div>
	</div>
</div>
{{/each}}
</template>

<template name="effects">
{{#if UserHasTransactions }}
	<canvas class="effects-line-chart"></canvas>
	<div class="effects-line-chart-controls">
		Chart shows
		<select class="months-to-show-select span1">
			{{#each SelectNumberOfMonthsOptions}}
			<option value="{{numMonths}}" 
					{{#if selected}}selected{{/if}}>
				{{numMonths}}
			</option>
			{{/each}}
		</select>
		recent months
	</div>
	{{#each Causes}}
		<h5>{{name}}</h5>
		<ul>
			{{#each Effects }}
			<li>{{unit}}: {{totalEffects}}</li>
			{{/each}}
		</ul>
	{{/each}}
{{else}}
	<p>No effects to display yet.</p>
{{/if}}
</template>
